<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>บันทึกเคสใหม่ - คลินิคยา มอ ออ จังหวัดตรัง</title>
    
    <!-- นำเข้า Kanit Font จาก Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- นำเข้า Tailwind CSS ผ่าน CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* กำหนด Kanit เป็น Font หลัก */
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #f7f9fb;
        }
        /* กำหนดความสูงของพื้นที่ Checkbox ให้สามารถ Scroll ได้ */
        #chief-complaints-list {
            max-height: 400px; 
            overflow-y: auto;
            border: 1px solid #ccc;
            border-radius: 0.375rem; /* rounded-md */
        }
        input[type="number"]::-webkit-inner-spin-button, 
        input[type="number"]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="min-h-screen">
    
    <!-- Header -->
    <header class="bg-white shadow-md">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-2xl font-semibold text-gray-900">บันทึก/แก้ไข ข้อมูลเคส</h1>
        </div>
    </header>

    <!-- Main Form Area -->
    <main class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
        
        <div class="bg-white p-8 rounded-xl shadow-lg">
            <!-- Form Start -->
            <form id="case-report-form">

                <h2 class="text-xl font-bold mb-6 text-indigo-700 border-b pb-2">1. ข้อมูลการรายงาน</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- สาขาที่รายงาน (Dropdown - อัปเดตแล้ว) -->
                    <div>
                        <label for="branch" class="block text-sm font-medium text-gray-700">สาขาที่รายงาน <span class="text-red-500">*</span></label>
                        <select id="branch" name="branch" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                            <option value="">-- เลือกสาขา --</option>
                            <!-- VALUE คือตัวเลขที่ส่งไป Apps Script, Text คือสิ่งที่ผู้ใช้เห็น -->
                            <option value="1">สาขา 1 นาเมืองเพชร</option>
                            <option value="2">สาขา 2 ที่วัง</option>
                            <option value="3">สาขา 3 คลองเต็ง</option>
                            <option value="4">สาขา 4 นาโยง</option>
                            <option value="5">สาขา 5 ท่ากลาง</option>
                            <option value="6">สาขา 6 รัษฎา</option>
                            <option value="7">สาขา 7 รักษ์จันทน์</option>
                            <option value="8">สาขา 8 หน้า รร.สภาราชินี</option>
                            <option value="9">สาขา 9 หน้า บิ๊กซ๊</option>
                        </select>
                    </div>
                    
                    <!-- ผู้รายงาน (Input Text) -->
                    <div>
                        <label for="reporter" class="block text-sm font-medium text-gray-700">ผู้รายงาน <span class="text-red-500">*</span></label>
                        <input type="text" id="reporter" name="reporter" required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                </div>

                <h2 class="text-xl font-bold mb-6 text-indigo-700 border-b pb-2">2. ข้อมูลผู้ป่วยและประวัติ</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- ชื่อ-สกุลผู้ป่วย -->
                    <div class="md:col-span-2">
                        <label for="patient_name" class="block text-sm font-medium text-gray-700">ชื่อ-สกุล ผู้ป่วย <span class="text-red-500">*</span></label>
                        <input type="text" id="patient_name" name="patient_name" required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    
                    <!-- เบอร์โทรศัพท์ -->
                    <div>
                        <label for="tel" class="block text-sm font-medium text-gray-700">เบอร์โทรศัพท์</label>
                        <input type="tel" id="tel" name="tel"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    
                    <!-- อายุ -->
                    <div>
                        <label for="age" class="block text-sm font-medium text-gray-700">อายุ (ปี)</label>
                        <input type="number" id="age" name="age" min="0" max="150"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    
                    <!-- น้ำหนัก & ส่วนสูง (ใช้ grid ภายใน) -->
                    <div class="md:col-span-2 grid grid-cols-2 gap-4">
                        <div>
                            <label for="weight" class="block text-sm font-medium text-gray-700">น้ำหนัก (กก.)</label>
                            <input type="number" id="weight" name="weight" step="0.1" min="1" max="500"
                                   class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="height" class="block text-sm font-medium text-gray-700">ส่วนสูง (ซม.)</label>
                            <input type="number" id="height" name="height" step="0.1" min="1" max="300"
                                   class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                        </div>
                    </div>

                    <!-- โรคประจำตัว -->
                    <div class="md:col-span-2">
                        <label for="chronic_disease" class="block text-sm font-medium text-gray-700">โรคประจำตัว (ถ้ามี)</label>
                        <textarea id="chronic_disease" name="chronic_disease" rows="2"
                                  placeholder="เช่น เบาหวาน, ความดันโลหิตสูง, หอบหืด..."
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                    </div>

                    <!-- ประวัติแพ้ยา -->
                    <div class="md:col-span-2">
                        <label for="drug_allergy" class="block text-sm font-medium text-gray-700">ประวัติแพ้ยา (ระบุชื่อยาและอาการ)</label>
                        <textarea id="drug_allergy" name="drug_allergy" rows="2"
                                  placeholder="ระบุว่าแพ้ยาอะไรและมีอาการแพ้อย่างไร..."
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                    </div>

                </div>

                <h2 class="text-xl font-bold mb-6 text-indigo-700 border-b pb-2">3. รายละเอียดเคสและการรักษา</h2>
                
                <div class="grid grid-cols-1 gap-6 mb-8">
                    
                    <!-- อาการสำคัญ (Checkboxes) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">อาการสำคัญ (เลือกได้มากกว่า 1) <span class="text-red-500">*</span></label>
                        <div id="chief-complaints-list" class="bg-gray-50 p-4">
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-4">
                                <!-- รายการอาการนำทั้งหมด 32 รายการ -->
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(01) Dizziness" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(01) Dizziness (เวียนศีรษะ)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(02) Headache" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(02) Headache (ปวดหัว)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(03) Pain in joint/muscle pain" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(03) ปวดข้อ/กล้ามเนื้อ</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(04) Toothache" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(04) Toothache (ปวดฟัน)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(05) Abdominal pain (Menstrual)" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(05) ปวดประจำเดือน</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(06) Stomachache" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(06) Stomachache (ปวดท้อง)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(07) Diarrhea" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(07) Diarrhea (ท้องเสีย)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(08) Constipation/Hemorrhoids" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(08) ท้องผูก/ริดสีดวงทวาร</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(09) Dysuria" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(09) Dysuria (ปัสสาวะแสบขัด)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(10) Vaginal discharge" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(10) Vaginal discharge (ตกขาว)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(11) Wound" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(11) Wound (แผล)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(12) Skin rash" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(12) Skin rash (ผื่นผิวหนัง)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(13) Eye disorder" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(13) Eye disorder (อาการทางตา)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(14) Ear disorder" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(14) Ear disorder (อาการทางหู)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(15) Fever/cough/sore throat" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(15) ไข้ ไอ เจ็บคอ</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(16) Covid-19" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(16) Covid-19 (ติดเชื้อโควิด)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(17) Rhinorrhea/ nasal congestion" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(17) น้ำมูก คัดจมูก</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(18) Ulcer in mouth" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(18) Ulcer in mouth (แผลในปาก)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(19) Herpes simplex" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(19) Herpes simplex (ตุ่มน้ำใสที่ปาก)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(20) Burn" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(20) Burn (แผลน้ำร้อนลวก)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(21) Itchy skin/head" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(21) อาการคันผิวหนัง/ศีรษะ</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(22) Helminthiasis" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(22) Helminthiasis (พยาธิ)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(23) Scabies" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(23) Scabies (หิด เหา)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(24) Cellulitis" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(24) Cellulitis (ฝี หนองที่ผิวหนัง)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(25) Beriberi" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(25) Beriberi (อาการชา/เหน็บชา)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(26) Insomnia" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(26) Insomnia (อาการนอนไม่หลับ)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(27) Motion sickness" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(27) Motion sickness (เมารถ เมาเรือ)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(28) Anorexia" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(28) Anorexia (เบื่ออาหาร)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(29) Nausea and vomitting" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(29) คลื่นไส้ อาเจียน</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(30) Drug/food allergy/insect bite" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(30) อาการแพ้ยา/อาหาร/แมลงกัดต่อย</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(31) Tobacco dependence" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(31) เจ็บป่วยจากการสูบบุหรี่)</span></div>
                                <div class="flex items-center"><input type="checkbox" name="chief_complaints" value="(32) Gingivitis" class="rounded text-indigo-600 focus:ring-indigo-500 h-4 w-4 mr-2"><span class="text-sm text-gray-800">(32) เหงือกอักเสบ/มีกลิ่นปาก)</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- ผลการซักประวัติ -->
                    <div>
                        <label for="history" class="block text-sm font-medium text-gray-700">ผลการซักประวัติ</label>
                        <textarea id="history" name="history" rows="3"
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                    </div>

                    <!-- วินิจฉัย -->
                    <div>
                        <label for="diagnosis" class="block text-sm font-medium text-gray-700">วินิจฉัย</label>
                        <input type="text" id="diagnosis" name="diagnosis"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>

                    <!-- วิธีการรักษา -->
                    <div>
                        <label for="treatment" class="block text-sm font-medium text-gray-700">วิธีการรักษา</label>
                        <textarea id="treatment" name="treatment" rows="3"
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                    </div>
                </div>

                <h2 class="text-xl font-bold mb-6 text-indigo-700 border-b pb-2">4. การติดตามอาการ</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- วันที่ติดตามอาการ -->
                    <div>
                        <label for="follow_up_date" class="block text-sm font-medium text-gray-700">วันที่ติดตามอาการ</label>
                        <input type="date" id="follow_up_date" name="follow_up_date"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500">
                    </div>
                    <!-- ผลการติดตาม -->
                    <div class="md:col-span-2">
                        <label for="follow_up_result" class="block text-sm font-medium text-gray-700">ผลการติดตาม (บันทึกเมื่อติดตามเรียบร้อย)</label>
                        <textarea id="follow_up_result" name="follow_up_result" rows="2"
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2.5 focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                    </div>
                </div>


                <!-- Action Buttons (ปุ่ม 3 ตัว) -->
                <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4 pt-4 border-t mt-8">
                    
                    <!-- ปุ่ม 1: บันทึกเคส (สถานะ: รอติดตาม) -->
                    <button type="submit" id="save-case-btn" data-status="pending"
                            class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                        <span class="text-lg">💾</span> บันทึกเคส (รอติดตาม)
                    </button>

                    <!-- ปุ่ม 2: ปิดเคส (สถานะ: ปิดเคสแล้ว + Export PDF) -->
                    <button type="button" id="close-case-btn" data-status="closed"
                            class="flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                        <span class="text-lg">✅</span> ปิดเคส (และ Export PDF)
                    </button>
                    
                    <!-- ปุ่ม 3: ยกเลิกเคส (ลบออกจากระบบ) -->
                    <button type="button" id="cancel-case-btn" 
                            class="flex-1 bg-gray-400 hover:bg-gray-500 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                        <span class="text-lg">❌</span> ยกเลิกเคส
                    </button>
                </div>
                
            </form>
            <!-- Form End -->
        </div>
        
    </main>

    <script src="script.js"></script>
</body>
</html>
